Version 4
SHEET 1 1372 740
WIRE 240 -80 -112 -80
WIRE 416 -80 416 -192
WIRE 416 -80 240 -80
WIRE 512 -80 416 -80
WIRE 1120 -80 1088 -80
WIRE 1216 -80 1200 -80
WIRE 1280 -80 1216 -80
WIRE 512 -48 512 -80
WIRE 1088 -48 1088 -80
WIRE -112 -32 -112 -80
WIRE -112 64 -112 32
WIRE -112 64 -640 64
WIRE 160 64 -112 64
WIRE 512 64 512 32
WIRE 832 64 512 64
WIRE 1024 64 832 64
WIRE 1280 64 1024 64
WIRE -112 96 -112 64
WIRE 832 112 832 64
WIRE 1024 112 1024 64
WIRE 1216 128 1216 -80
WIRE 1216 128 1072 128
WIRE 1088 176 1088 32
WIRE 1088 176 1072 176
WIRE 64 208 -640 208
WIRE 512 208 512 64
WIRE 576 208 512 208
WIRE 160 224 160 64
WIRE 160 224 128 224
WIRE 656 224 640 224
WIRE 832 224 832 176
WIRE 832 224 736 224
WIRE 1024 224 1024 192
WIRE 1024 224 832 224
WIRE 1280 224 1024 224
WIRE 64 240 -16 240
WIRE 576 240 512 240
WIRE -16 256 -16 240
WIRE 512 288 512 240
WIRE 240 304 240 -80
WIRE 416 304 416 -80
WIRE 464 304 416 304
WIRE 464 352 416 352
WIRE -496 368 -640 368
WIRE -400 368 -496 368
WIRE -304 368 -400 368
WIRE -192 368 -304 368
WIRE 64 368 -192 368
WIRE -304 384 -304 368
WIRE -192 384 -192 368
WIRE 192 384 128 384
WIRE 416 384 416 352
WIRE -496 400 -496 368
WIRE -400 400 -400 368
WIRE 64 400 48 400
WIRE 48 448 48 400
WIRE 240 448 240 400
WIRE 240 448 48 448
WIRE -496 496 -496 464
WIRE -400 496 -400 464
WIRE -400 496 -496 496
WIRE -304 496 -304 464
WIRE -304 496 -400 496
WIRE -192 496 -192 464
WIRE -192 496 -304 496
WIRE -112 496 -112 160
WIRE -112 496 -192 496
WIRE -16 496 -16 336
WIRE -16 496 -112 496
WIRE 416 496 416 464
WIRE 416 496 -16 496
WIRE 512 496 512 368
WIRE 512 496 416 496
WIRE 1088 496 1088 176
WIRE 1088 496 512 496
WIRE 240 544 240 448
WIRE 240 544 -640 544
WIRE 416 608 416 496
FLAG -640 208 REGS
FLAG -640 64 REGF
FLAG -640 368 VIN
FLAG -640 544 SET
FLAG 416 -192 VSP
FLAG 416 608 GNDIN
FLAG 1280 64 IS
FLAG 1280 224 VG
FLAG 1280 -80 OD
SYMBOL Opamps\\opamp 96 160 R0
SYMATTR InstName U1
SYMBOL Opamps\\opamp 96 448 M180
SYMATTR InstName U2
SYMBOL Opamps\\opamp 608 160 R0
SYMATTR InstName U3
SYMBOL diode -96 32 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value ES1D
SYMBOL diode -96 160 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value ES1D
SYMBOL voltage -16 240 M0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 3
SYMBOL res -176 368 M0
SYMATTR InstName Rin
SYMATTR Value 2.4G
SYMATTR SpiceLine pwr=1
SYMBOL current -304 384 M0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Ib
SYMATTR Value -15n
SYMBOL cap -384 400 M0
SYMATTR InstName Cin
SYMATTR Value 30p
SYMATTR SpiceLine V=100 Irms=1
SYMBOL diode -480 464 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMATTR Value ES1D
SYMBOL nmos 192 304 R0
SYMATTR InstName M1
SYMBOL voltage 416 368 M0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value 1.4
SYMBOL e 512 272 R0
SYMATTR InstName E1
SYMATTR Value 1
SYMBOL bi 512 -48 R0
SYMATTR InstName B1
SYMATTR Value I=Id(M1)*10
SYMBOL res 640 240 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value 10
SYMATTR SpiceLine pwr=1
SYMBOL zener 848 176 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value EDZV16B
SYMBOL sw 1024 208 R180
SYMATTR InstName S1
SYMATTR Value XTR111SW
SYMBOL voltage 1088 -64 M0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL current 1120 -80 R270
WINDOW 0 32 40 VTop 2
WINDOW 3 -32 40 VBottom 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName I1
SYMATTR Value 4µ
TEXT -576 -136 Left 2 !.model XTR111SW SW(Ron=1n Roff=1G Vt=1.2 Vh=0.6)
TEXT -576 -104 Left 2 !.lib opamp.sub
RECTANGLE Normal 1248 576 -608 -160 2
